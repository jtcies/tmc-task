---
title: "D&T Hiring Test"
output: html_document
---

```{r setup}

knitr::opts_chunk$set(echo = TRUE)

readr::read_csv("data/voteshare.csv")
readr::read_csv("data/candidate.csv")

```

## Task 1: SQL

```{python}

import pandas
from sqlalchemy import create_engine

engine = create_engine('sqlite://', echo=False)
conn = engine.raw_connection()

voteshare = pandas.read_csv("data/voteshare.csv")

candidate = pandas.read_csv("data/candidate.csv")
                
voteshare.to_sql('voteshare', conn, if_exists='replace', index=False)
candidate.to_sql("candidate", conn, if_exists='replace', index=False)



engine.execute("SELECT * FROM voteshare").fetchall()


```

